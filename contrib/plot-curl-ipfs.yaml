---

upstreams:
  ipfs_io:
    url: https://ipfs.io/

tls:
  names: ["ipfs.io"]

check:
  image: archlinux
  install_certs: ['tee', '-a', '/etc/ssl/certs/sh4d0wup.crt']
  register_hosts:
    - ipfs.io
  cmds:
    - pacman -Suy --noconfirm curl
    - cat /etc/ssl/certs/sh4d0wup.crt >> /etc/ssl/certs/ca-certificates.crt
    - mkdir -p "$HOME/.ipfs"
    - echo https://ipfs.io > "$HOME/.ipfs/gateway"
    # Hello World
    - curl -sSvf ipfs://QmWATWQ7fVPP2EFGu71UkfnqhYXDYH566qy47CnJDgvs8u

routes:
  - path: "/ipfs/QmWATWQ7fVPP2EFGu71UkfnqhYXDYH566qy47CnJDgvs8u"
    type: static
    args:
      data: |
        IPFS response has been tampered with ðŸ˜ˆ
  - type: proxy
    args:
      upstream: ipfs_io
